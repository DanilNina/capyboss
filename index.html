<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CapyBoss - Услуги мастеров</title>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        h1 {
            color: #2DD4BF;
            font-size: 24px;
            margin-bottom: 20px;
        }
        .service-card {
            display: inline-block;
            margin: 10px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .service-card:hover {
            transform: scale(1.1);
        }
        lottie-player {
            width: 100px;
            height: 100px;
        }
        p {
            color: #333;
            font-size: 14px;
            margin: 5px 0 0 0;
        }
        .subservices {
            display: none;
            margin-top: 20px;
        }
        .subservice-btn {
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            background-color: #2DD4BF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        .subservice-btn:hover {
            background-color: #F97316;
        }
    </style>
</head>
<body>
    <h1>Выбери услугу</h1>
    <div id="servicesContainer"></div>
    <div id="subservicesContainer" class="subservices"></div>

    <script>
        // Данные об услугах и подуслугах
        const services = {
            "Ремонт под ключ": {
                icon: "menu.json",
                subservices: ["Комплексный ремонт", "Дизайн-проект", "Закупка материалов"]
            },
            "Электрика": {
                icon: "electricity.json",
                subservices: ["Электромонтаж квартиры/дома", "Установка розеток/выключателей", "Монтаж люстр/светильников", "Прокладка проводки"]
            },
            "Сантехника": {
                icon: "pipes.json",
                subservices: ["Установка сантехники", "Установка душевых кабинок", "Прочистка засоров", "Замена труб", "Установка водонагревателей"]
            },
            "Строительно-отделочные работы": {
                icon: "hammer.json",
                subservices: ["Укладка плитки", "Гипсокартон", "Штукатурка и выравнивание", "Покраска стен/потолков", "Бетонные работы", "Демонтаж конструкций"]
            },
            "Мебель и сборка": {
                icon: "furniture.json",
                subservices: ["Сборка мебели", "Навешивание полок, зеркал", "Ремонт мебели"]
            },
            "Напольные покрытия": {
                icon: "flooring.json",
                subservices: ["Укладка ламината/паркета", "Монтаж линолеума"]
            },
            "Окна, двери": {
                icon: "window.json",
                subservices: ["Установка окон", "Монтаж дверей"]
            },
            "Фасадные и кровельные работы": {
                icon: "roof.json",
                subservices: ["Монтаж/ремонт кровли", "Утепление фасадов"]
            },
            "Сварочные работы": {
                icon: "welding.json",
                subservices: ["Сварка металлоконструкций", "Сварка труб"]
            },
            "Мелкий бытовой ремонт": {
                icon: "wrench.json",
                subservices: ["Замена замков, ручек", "Ремонт розеток/выключателей", "Установка телевизоров"]
            },
            "Бытовая техника": {
                icon: "appliance.json",
                subservices: ["Ремонт холодильников, стиральных машин", "Установка кондиционеров"]
            },
            "Дополнительные услуги": {
                icon: "box.json",
                subservices: ["Установка видеодомофонов", "Услуги грузчика"]
            }
        };

        // Инициализация Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // Отображение категорий
        const servicesContainer = document.getElementById('servicesContainer');
        const subservicesContainer = document.getElementById('subservicesContainer');

        Object.entries(services).forEach(([service, data]) => {
            const card = document.createElement('div');
            card.className = 'service-card';
            card.innerHTML = `<lottie-player src="${data.icon}" loop></lottie-player><p>${service}</p>`;
            card.addEventListener('click', () => {
                // Показать подуслуги
                subservicesContainer.style.display = 'block';
                subservicesContainer.innerHTML = `<h2>${service}</h2>`;
                data.subservices.forEach(sub => {
                    const btn = document.createElement('button');
                    btn.className = 'subservice-btn';
                    btn.textContent = sub;
                    btn.addEventListener('click', () => {
                        // Отправить данные в Telegram
                        tg.sendData(JSON.stringify({ service, subservice: sub }));
                        tg.close();
                    });
                    subservicesContainer.appendChild(btn);
                });
                // Прокрутить к подуслугам
                subservicesContainer.scrollIntoView({ behavior: 'smooth' });
            });
            servicesContainer.appendChild(card);
        });

        // Обработка кнопки "Назад" в Telegram
        tg.BackButton.onClick(() => {
            subservicesContainer.style.display = 'none';
            subservicesContainer.innerHTML = '';
            servicesContainer.scrollIntoView({ behavior: 'smooth' });
        });
    </script>
</body>
</html>
